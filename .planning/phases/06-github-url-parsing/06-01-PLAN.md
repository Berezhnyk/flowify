# Plan 06-01: GitHub URL Parsing

## Goal

Detect GitHub URLs in chat input, parse repo/branch/path components. This enables users to paste a GitHub URL and have the AI analyze that repository's code.

## Why This Approach

Parse GitHub URLs to extract:
- Owner (username or org)
- Repository name
- Branch (default to main/master)
- Path (optional subdirectory)

Support URL formats:
- `https://github.com/owner/repo`
- `https://github.com/owner/repo/tree/branch`
- `https://github.com/owner/repo/tree/branch/path/to/dir`
- `https://github.com/owner/repo/blob/branch/path/to/file`

## Tasks

### Task 1: Create GitHub URL parser utility

Create `src/utils/github.ts`:

```typescript
import type { GitHubRepo } from '@/types'

const GITHUB_URL_REGEX = /^https?:\/\/github\.com\/([^\/]+)\/([^\/]+)(?:\/(tree|blob)\/([^\/]+)(?:\/(.+))?)?/

export function isGitHubUrl(url: string): boolean {
  return GITHUB_URL_REGEX.test(url.trim())
}

export function parseGitHubUrl(url: string): GitHubRepo | null {
  const match = url.trim().match(GITHUB_URL_REGEX)
  if (!match) return null

  const [, owner, repo, type, branch, path] = match

  return {
    owner,
    repo: repo.replace(/\.git$/, ''),
    branch: branch || 'main',
    path: path || undefined,
  }
}

export function buildGitHubApiUrl(repo: GitHubRepo): string {
  const base = `https://api.github.com/repos/${repo.owner}/${repo.repo}/contents`
  const path = repo.path ? `/${repo.path}` : ''
  return `${base}${path}?ref=${repo.branch}`
}
```

**Verification:**
- [x] File created at `src/utils/github.ts`
- [x] Parses various GitHub URL formats
- [x] Extracts owner, repo, branch, path correctly

### Task 2: Add URL detection to ChatInput

Update ChatInput to detect GitHub URLs on paste and emit event:

```typescript
interface Emits {
  // ... existing
  (e: 'github-url', url: string): void
}

function handlePaste(event: ClipboardEvent) {
  const text = event.clipboardData?.getData('text')
  if (text && isGitHubUrl(text)) {
    event.preventDefault()
    emit('github-url', text.trim())
  }
}
```

Add to template:
```html
<textarea ... @paste="handlePaste">
```

**Verification:**
- [x] Paste event handled
- [x] GitHub URLs detected
- [x] Event emitted with URL

### Task 3: Handle GitHub URL in ChatPanel

Update ChatPanel to receive github-url event and parse:

```typescript
import { parseGitHubUrl, isGitHubUrl } from '@/utils/github'

function handleGitHubUrl(url: string) {
  const repo = parseGitHubUrl(url)
  if (repo) {
    contextStore.setGitHubRepo(repo)
    // Actual fetching will be in Phase 7
    console.log('GitHub repo parsed:', repo)
  }
}
```

**Verification:**
- [x] GitHub URL parsed on paste
- [x] Repo info stored in context store
- [x] No TypeScript errors

## Verification

After completing all tasks:

1. **Type check passes:**
   ```bash
   npm run type-check
   ```

2. **Manual testing:**
   - Paste `https://github.com/vuejs/vue` into chat
   - Check console for parsed repo info
   - Verify contextStore.githubRepo is set

## Estimated Scope

- **Task 1:** ~30 lines (parser utility)
- **Task 2:** ~15 lines (ChatInput update)
- **Task 3:** ~15 lines (ChatPanel handler)
- **Total:** ~60 lines
